<c-col xs="12">
  <c-card class="card-btn" style="border: none">
    <div class="mb-4" style="text-align: right; margin: 15px 15px 0px 15px">
      <button
        pButton
        type="button"
        class="btn btn-primary btn-sm"
        (click)="showAdd()"
      >
        <i style="color: white" class="pi pi-plus"></i> Tambah Pelanggan
      </button>
    </div>
  </c-card>
  <!-- section confirmation -->
  <p-confirmDialog #cd [style]="{ width: '50vw' }">
    <ng-template pTemplate="footer">
      <!-- <button type="button" pButton icon="pi pi-times" label="No" (click)="cd.reject()"></button> -->
      <button
        type="button"
        pButton
        icon="pi pi-check"
        label="OK"
        (click)="cd.accept()"
      ></button>
    </ng-template>
  </p-confirmDialog>

  <!-- section form -->
  <p-dialog
    header="{{ header }}"
    [(visible)]="masterform"
    [style]="{ width: '50%' }"
    [draggable]="false"
    [dismissableMask]="false"
  >
    <div>
      <hr />
      <div class="mt-4">
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <div *ngIf="isEdit || isDelete">
              <label>ID Pelanggan</label>
              <input
                type="text"
                formControlName="idPelanggan"
                class="form-control"
                [ngClass]="{
                  'is-invalid': submitted && f['idPelanggan'].errors
                }"
              />
              <div
                *ngIf="submitted && f['idPelanggan'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['idPelanggan'].errors['required']">
                  ID Pelanggan belum diisi
                </div>
                <div *ngIf="f['idPelanggan'].errors['minlength']">
                  ID Pelanggan memiliki minimal
                  {{ f["idPelanggan"].errors["minlength"]["requiredLength"] }}
                  karakter
                </div>
                <div *ngIf="f['idPelanggan'].errors['maxlength']">
                  ID Pelanggan memiliki maksimal
                  {{ f["idPelanggan"].errors["maxlength"]["requiredLength"] }}
                  karakter
                </div>
              </div>
            </div>

            <label>ID Pengguna</label>
            <select
              class="form-select"
              formControlName="userId"
              aria-label="select users"
              (change)="changeSelect($event)"
            >
              <option value="">(choose)</option>
              <option *ngFor="let item of users" value="{{ item.userId }}">
                {{ item.userId }}: {{ item.nama }}
              </option>
            </select>

            <div
              *ngIf="submitted && f['userId'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['userId'].errors['required']">Input ID user</div>
            </div>

            <label>Nama</label>
            <input
              type="text"
              formControlName="nama"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['nama'].errors }"
            />
            <div *ngIf="submitted && f['nama'].errors" class="invalid-feedback">
              <div *ngIf="f['nama'].errors['required']">Nama belum diisi</div>
              <div *ngIf="f['nama'].errors['minlength']">
                Nama memiliki minimal
                {{ f["nama"].errors["minlength"]["requiredLength"] }} karakter
              </div>
              <div *ngIf="f['nama'].errors['maxlength']">
                Nama memiliki maksimal
                {{ f["nama"].errors["maxlength"]["requiredLength"] }} karakter
              </div>
            </div>

            <label>No. Telp</label>
            <input
              type="text"
              formControlName="noTelp"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['noTelp'].errors }"
            />
            <div
              *ngIf="submitted && f['noTelp'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['noTelp'].errors['required']">
                No. Telepon belum diisi
              </div>
              <div *ngIf="f['noTelp'].errors['maxlength']">
                No. Telp memiliki maksimal
                {{ f["noTelp"].errors["maxlength"]["requiredLength"] }} karakter
              </div>
            </div>

            <label>Alamat</label>
            <input
              type="text"
              formControlName="alamat"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['alamat'].errors }"
            />
            <div
              *ngIf="submitted && f['alamat'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['alamat'].errors['required']">
                Alamat dibutuhkan
              </div>
              <div *ngIf="f['alamat'].errors['maxlength']">
                Alamat memiliki maksimal
                {{ f["alamat"].errors["maxlength"]["requiredLength"] }} karakter
              </div>
            </div>
          </div>

          <div *ngIf="isEdit || isAdd" class="form-group mt-4" align="center">
            <button pButton type="submit" class="btn p-button-primary">
              Submit
            </button>
            &nbsp;
            <button
              pButton
              type="button"
              (click)="onReset()"
              class="btn p-button-danger float-right"
            >
              Reset
            </button>
          </div>
          <div *ngIf="isDelete" class="form-group mt-4" align="center">
            <button
              pButton
              type="submit"
              class="btn p-button-danger"
              style="color: white"
              (click)="onDelete()"
            >
              Delete
            </button>
            &nbsp;
          </div>
        </form>
      </div>
    </div>
  </p-dialog>
  <c-card class="mb-4">
    <c-card-header>
      <!-- <strong>Employee List <span>({{ pelanggan?.length}} data)</span></strong> -->
      <strong>Master Pelanggan</strong>
    </c-card-header>


    <!-- section data tabel -->
    <div class="tab-content rounded-bottom">
      <div
        class="tab-pane p-3 active preview table-responsive"
        role="tabpanel"
        id="preview-24"
      >
        <p-table
        #dt2
        [globalFilterFields]="['idPelanggan','nama','noTelp','alamat','userId']"
        dataKey="id"
          [value]="pelanggan"
          [paginator]="true"
          [rows]="5"
          [rowsPerPageOptions]="[5, 10, 15, 20]"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        >
        <!-- <ng-template pTemplate="caption">
          <div class="flex">
              <span class="p-input-icon-left ml-auto">
                  <i class="pi pi-search"></i>
                  <input pInputText type="text" (input)="dt2.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />
              </span>
          </div>
      </ng-template> -->
          <ng-template pTemplate="header">
            <tr>
              <!-- <th *ngFor="let col of cols">
                                {{col.header}}
                            </th> -->
              <th pSortableColumn="idPelanggan">
                ID Pelanggan
                <p-sortIcon field="idPelanggan"></p-sortIcon>
              </th>
              <th pSortableColumn="nama">
                Nama
                <p-sortIcon field="nama"></p-sortIcon>
                <p-columnFilter type="text" field="nama" display="nama"></p-columnFilter>
              </th>
              <th pSortableColumn="noTelp">
                Nomor Telepon
                <p-sortIcon field="noTelp"></p-sortIcon>
              </th>
              <th pSortableColumn="alamat">
                Alamat
                <p-sortIcon field="alamat"></p-sortIcon>
              </th>
              <th pSortableColumn="userId">
                ID Pengguna
                <p-sortIcon field="userId"></p-sortIcon>
              </th>
              <th>Action</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-pelanggan>
            <tr>
              <td *ngFor="let col of cols">
                {{ pelanggan[col.field] }}
              </td>
              <td>
                <button
                  pButton
                  type="button"
                  class="btn p-button-success btn-sm"
                  (click)="showEdit(pelanggan)"
                >
                  <i style="color: white" class="pi pi-pencil"></i>
                </button>
                <button
                  pButton
                  type="button"
                  class="btn p-button-danger btn-sm"
                  (click)="showdelete(pelanggan)"
                >
                  <i style="color: white" class="pi pi-trash"></i>
                </button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>

    <c-card-body></c-card-body></c-card
></c-col>



<!-- TAMPIL DIALOG (ERROR) NO REK TIDAK DITEMUKAN  -->
<p-dialog #cek header="Info" [(visible)]="cekError" [style]="{width: '50vw'}" [draggable]="false" [resizable]="false">
  <c-card-body>
      <div>
          <p><b>Pengguna Sudah Terdaftar</b></p>
      </div>
  </c-card-body>
  <ng-template pTemplate="footer">
      <button type="button" class="p-button-danger" pButton icon="pi pi-times" label="Tutup"
          (click)="onResetNew()"></button>
  </ng-template>
</p-dialog>
