<link rel="preconnect" href="https://fonts.googleapis.com" /><link
  rel="preconnect"
  href="https://fonts.gstatic.com"
  crossorigin
/><link
  href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap"
  rel="stylesheet"
/>

<c-col xs="12">
  <div class="mb-4" style="text-align: right; margin: 15px 15px 0px 15px">
    <button pButton type="button" class="btn p-button-primary btn-sm" (click)="showAdd()">
      <i style="color: white" class="pi pi-plus"></i>Tambah History
    </button>
  </div>

  <!-- section confirmation -->
  <p-confirmDialog #cd [style]="{ width: '50vw' }">
    <ng-template pTemplate="footer">
      <!-- <button type="button" pButton icon="pi pi-times" label="No" (click)="cd.reject()"></button> -->
      <button
        type="button"
        pButton
        icon="pi pi-check"
        label="OK"
        (click)="cd.accept()"
      ></button>
    </ng-template>
  </p-confirmDialog>

  <!-- section form -->
  <p-dialog
    header="{{ header }}"
    [(visible)]="telpHistoryForm"
    [style]="{ width: '50%' }"
    [draggable]="false"
    [dismissableMask]="false"
  >
    <div>
      <hr />
      <div class="mt-4">
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <!-- <div *ngIf="isEdit || isDelete"> -->
            <div *ngIf="isEdit || isDelete">
              <label class="font-primary">ID history</label>
              <input
                type="text"
                formControlName="idHistory"
                class="form-control"
                [ngClass]="{ 'is-invalid': submitted && f['idHistory'].errors }"
              />
              <div
                *ngIf="submitted && f['idHistory'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['idHistory'].errors['required']">
                  ID history belum diisi
                </div>
                <div *ngIf="f['idHistory'].errors['minlength']">
                  ID history min
                  {{ f["idHistory"].errors["minlength"]["requiredLength"] }}
                  character
                </div>
                <div *ngIf="f['idHistory'].errors['maxlength']">
                  ID history max
                  {{ f["idHistory"].errors["maxlength"]["requiredLength"] }}
                  character
                </div>
              </div>
            </div>

            <label>Tanggal Bayar</label>
            <input
              type="date"
              formControlName="tanggalBayar"
              class="form-control"
              [ngClass]="{
                'is-invalid': submitted && f['tanggalBayar'].errors
              }"
            />
            <div
              *ngIf="submitted && f['tanggalBayar'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['tanggalBayar'].errors['required']">
                Tanggal bayar belum diisi
              </div>
            </div>

            <label>ID Pelanggan</label>
            <select
              class="form-select"
              formControlName="idPelanggan"
              aria-label="select pelanggan"
            >
              <option value="">(choose)</option>
              <option
                *ngFor="let item of pelanggan"
                value="{{ item.idPelanggan }}"
              >
                {{ item.idPelanggan }} : {{ item.nama }}
              </option>
            </select>
            <div
              *ngIf="submitted && f['idPelanggan'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['idPelanggan'].errors['required']">
                ID Pelanggan belum diisi
              </div>
            </div>

            <label>Bulan Tagihan</label>
            <input
              type="number"
              formControlName="bulanTagihan"
              class="form-control"
              [ngClass]="{
                'is-invalid': submitted && f['bulanTagihan'].errors
              }"
            />
            <div
              *ngIf="submitted && f['bulanTagihan'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['bulanTagihan'].errors['required']">
                Bulan tagihan belum diisi
              </div>
              <div *ngIf="f['bulanTagihan'].errors['minlength']">
                Bulan tagihan memiliki minimal
                {{ f["bulanTagihan"].errors["minlength"]["requiredLength"] }}
                karakter
              </div>
              <div *ngIf="f['bulanTagihan'].errors['maxlength']">
                Bulan tagihan memiliki maksimal
                {{ f["bulanTagihan"].errors["maxlength"]["requiredLength"] }}
                karakter
              </div>
            </div>

            <label>Tahun Tagihan</label>
            <input
              type="number"
              formControlName="tahunTagihan"
              class="form-control"
              [ngClass]="{
                'is-invalid': submitted && f['tahunTagihan'].errors
              }"
            />
            <div
              *ngIf="submitted && f['tahunTagihan'].errors"
              class="invalid-feedback"
            >
              <div *ngIf="f['tahunTagihan'].errors['required']">
                Tahun tagihan belum diisi
              </div>
              <div *ngIf="f['tahunTagihan'].errors['minlength']">
                Tahun tagihan memiliki minimal
                {{ f["tahunTagihan"].errors["minlength"]["requiredLength"] }}
                karakter
              </div>
              <div *ngIf="f['tahunTagihan'].errors['maxlength']">
                Tahun tagihan memiliki maksimal
                {{ f["tahunTagihan"].errors["maxlength"]["requiredLength"] }}
                karakter
              </div>
            </div>

            <label>Nominal Tagihan</label>
            <input
              type="number"
              formControlName="uang"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['uang'].errors }"
            />
            <div *ngIf="submitted && f['uang'].errors" class="invalid-feedback">
              <div *ngIf="f['uang'].errors['required']">
                Nominal tagihan belum diisi
              </div>
              <div *ngIf="f['uang'].errors['maxlength']">
                Nominal tagihan memiliki maksimal
                {{ f["uang"].errors["maxlength"]["requiredLength"] }} karakter
              </div>
            </div>
          </div>

          <div *ngIf="isEdit || isAdd" class="form-group mt-4" align="center">
            <button type="submit" class="btn btn-primary">Submit</button> &nbsp;
            <button
              type="button"
              (click)="onReset()"
              class="btn btn-warning float-right"
            >
              Reset
            </button>
          </div>
          <div *ngIf="isDelete" class="form-group mt-4" align="center">
            <button
              type="submit"
              class="btn btn-danger"
              style="color: white"
              (click)="onDelete()"
            >
              Delete
            </button>
            &nbsp;
          </div>
        </form>
      </div>
    </div>
  </p-dialog>
  <c-card class="mb-4">
    <c-card-header>
      <!-- <strong>Employee List <span>({{ pelanggan?.length}} data)</span></strong> -->
      <strong>Telp History</strong>
    </c-card-header>

    <!-- section data tabel -->
    <div class="tab-content rounded-bottom">
      <div
        class="tab-pane p-3 active preview table-responsive"
        role="tabpanel"
        id="preview-24"
      >
        <p-table
          [value]="telpHistory"
          [paginator]="true"
          [rows]="5"
          [rowsPerPageOptions]="[5, 10, 15, 20]"
        >
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="idHistory">
                ID History
                <p-sortIcon field="idHistory"></p-sortIcon>
              </th>
              <th pSortableColumn="idPelanggan">
                ID Pelanggan
                <p-sortIcon field="idPelanggan"></p-sortIcon>
              </th>
              <th pSortableColumn="tanggalBayar">
                Tanggal Bayar
                <p-sortIcon field="tanggalBayar"></p-sortIcon>
              </th>
              <th pSortableColumn="bulanTagihan">
                Bulan Tagihan
                <p-sortIcon field="bulanTagihan"></p-sortIcon>
              </th>
              <th pSortableColumn="tahunTagihan">
                Tahun Tagihan
                <p-sortIcon field="tahunTagihan"></p-sortIcon>
              </th>
              <th pSortableColumn="uang">
                Nominal Tagihan
                <p-sortIcon field="uang"></p-sortIcon>
              </th>
              <!-- <th>Action</th> -->
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-history>
            <tr>
              <!-- <td *ngFor="let col of cols">
                {{ history[col.field] }}
              </td> -->
              <td>{{history.idHistory}}</td>
              <td>{{history.idPelanggan}}</td>
              <td>{{history.tanggalBayar}}</td>
              <td>{{history.bulanTagihan}}</td>
              <td>{{history.tahunTagihan}}</td>
              <td>{{history.uang | currency:'IDR ':'symbol':'3.2-2'}}</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>

    <c-card-body></c-card-body></c-card
></c-col>
